å¥½çš„ï¼Œæˆ‘ä»¬æ¥æ ä¸€ä¸ªå®Œå…¨ä»é›¶å¼€å§‹ã€è‡ªåŠ¨è”ç½‘éƒ¨ç½²ã€é€‚é… Win10/11ã€æ”¯æŒä»£ç†çš„ã€Œä¸€é”®å®‰è£… VNC + noVNC è„šæœ¬ã€ï¼Œåšåˆ°ï¼š

âœ… æ–°è£…ç³»ç»Ÿï¼Œæ— éœ€é¢„è£…è½¯ä»¶

âœ… è‡ªåŠ¨å®‰è£… Pythonã€TigerVNCã€websockify

âœ… ä¸‹è½½ noVNC å’Œ NSSM

âœ… è‡ªåŠ¨æ³¨å†Œåå°æœåŠ¡

âœ… æ”¯æŒä½ æä¾›çš„ä»£ç†åœ°å€ï¼ˆhttps://proxy.grep2000.com:710ï¼‰

âœ… æœ€ç»ˆåˆ«çš„ç”µè„‘åªéœ€æ‰“å¼€æµè§ˆå™¨è¾“å…¥ï¼šhttp://<æœ¬æœºIP>:6104/vnc.html å³å¯è¿œç¨‹è®¿é—®

âœ… ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼šinstall-vnc-novnc.ps1ï¼ˆPowerShellï¼‰
è¯·å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶ä¿å­˜ä¸º install-vnc-novnc.ps1ï¼Œå³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell å³å¯éƒ¨ç½²ã€‚

powershell
å¤åˆ¶
ç¼–è¾‘
# è®¾ç½®ä»£ç†
$env:http_proxy = "http://proxy.grep2000.com:710"
$env:https_proxy = "http://proxy.grep2000.com:710"

# åˆ›å»ºå·¥ä½œç›®å½•
$workDir = "$env:USERPROFILE\vnc_novnc"
New-Item -ItemType Directory -Path $workDir -Force | Out-Null
Set-Location $workDir

# ä¸‹è½½å¹¶å®‰è£… Pythonï¼ˆé™é»˜ï¼‰
Write-Host "ğŸ“¦ å®‰è£… Python..."
$pythonInstaller = "$workDir\python-installer.exe"
Invoke-WebRequest -Uri "https://www.python.org/ftp/python/3.10.10/python-3.10.10-amd64.exe" -OutFile $pythonInstaller
Start-Process -Wait -FilePath $pythonInstaller -ArgumentList "/quiet InstallAllUsers=1 PrependPath=1"

# å®‰è£… pip åŒ…ï¼šwebsockify
Write-Host "ğŸ“¦ å®‰è£… websockify..."
$env:Path += ";C:\Program Files\Python310\Scripts;C:\Program Files\Python310\"
pip install websockify

# ä¸‹è½½ noVNC
Write-Host "ğŸŒ ä¸‹è½½ noVNC..."
Invoke-WebRequest -Uri "https://github.com/novnc/noVNC/archive/refs/tags/v1.4.0.zip" -OutFile "$workDir\novnc.zip"
Expand-Archive "$workDir\novnc.zip" -DestinationPath "$workDir\novnc"
Rename-Item "$workDir\novnc\noVNC-1.4.0" "$workDir\novnc\web"

# ä¸‹è½½ NSSMï¼ˆæœåŠ¡æ³¨å†Œå·¥å…·ï¼‰
Write-Host "ğŸ“¦ ä¸‹è½½ NSSM..."
Invoke-WebRequest -Uri "https://nssm.cc/release/nssm-2.24.zip" -OutFile "$workDir\nssm.zip"
Expand-Archive "$workDir\nssm.zip" -DestinationPath "$workDir\nssm"
$NSSM = "$workDir\nssm\nssm-2.24\win64\nssm.exe"

# ä¸‹è½½å¹¶å®‰è£… TigerVNCï¼ˆé™é»˜å®‰è£…ï¼‰
Write-Host "ğŸ“º å®‰è£… TigerVNC..."
$VNCInstaller = "$workDir\tigervnc.exe"
Invoke-WebRequest -Uri "https://github.com/TigerVNC/tigervnc/releases/download/v1.12.0/tigervnc64-1.12.0.exe" -OutFile $VNCInstaller
Start-Process -Wait -FilePath $VNCInstaller -ArgumentList "/silent"

# é…ç½® VNC å¯†ç 
Write-Host "ğŸ” è®¾ç½® VNC å¯†ç ä¸ºï¼š123456"
$vncPassDir = "$env:USERPROFILE\.vnc"
New-Item -ItemType Directory -Force -Path $vncPassDir | Out-Null
"123456" | & 'C:\Program Files\TigerVNC\vncpasswd.exe' -f > "$vncPassDir\passwd"

# åˆ›å»ºè¿è¡Œ bat è„šæœ¬
$batScript = @"
@echo off
python -m websockify 6104 localhost:5900 --web=$workDir\novnc\web
"@
$batPath = "$workDir\run_websockify.bat"
$batScript | Out-File -Encoding ASCII -FilePath $batPath

# æ³¨å†Œ websockify æœåŠ¡
Write-Host "ğŸ”§ æ³¨å†Œ websockify æœåŠ¡..."
Start-Process -Wait -FilePath $NSSM -ArgumentList "install noVNC", "$batPath"

# è®¾ç½®æœåŠ¡è‡ªåŠ¨å¯åŠ¨å¹¶å¯åŠ¨
Start-Process -Wait -FilePath $NSSM -ArgumentList "set noVNC Start SERVICE_AUTO_START"
Start-Service -Name noVNC

# å¼€æ”¾é˜²ç«å¢™ç«¯å£
Write-Host "ğŸ§± æ”¾è¡Œé˜²ç«å¢™ç«¯å£ 5900 å’Œ 6104..."
netsh advfirewall firewall add rule name="Allow VNC" dir=in action=allow protocol=TCP localport=5900
netsh advfirewall firewall add rule name="Allow noVNC" dir=in action=allow protocol=TCP localport=6104

# æ‰“å°ç»“æœ
$ip = (Get-NetIPAddress -AddressFamily IPv4 | Where-Object { $_.InterfaceAlias -notlike "*Loopback*" -and $_.IPAddress -notlike "169.*" }).IPAddress | Select-Object -First 1
Write-Host "`nğŸ‰ å®‰è£…å®Œæˆï¼è¯·ä½¿ç”¨å…¶ä»–ç”µè„‘è®¿é—®ï¼š" -ForegroundColor Green
Write-Host "ğŸ‘‰ http://$ip:6104/vnc.html" -ForegroundColor Yellow
âœ… ä½¿ç”¨è¯´æ˜
æ–°è£… Windows åï¼Œå³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell

æ‰§è¡Œå‘½ä»¤è¿è¡Œè„šæœ¬ï¼š

powershell
å¤åˆ¶
ç¼–è¾‘
Set-ExecutionPolicy Bypass -Scope Process -Force
iwr -useb https://raw.githubusercontent.com/ä½ çš„é“¾æ¥/install-vnc-novnc.ps1 | iex
ï¼ˆæˆ–ç›´æ¥æŠŠè„šæœ¬ä¿å­˜ä¸º .ps1 æœ¬åœ°è¿è¡Œï¼‰

âœ… æ•ˆæœé¢„è§ˆ
ä½ å°†åœ¨å…¶ä»–ç”µè„‘ã€æ‰‹æœºã€æµè§ˆå™¨ä¸­è¾“å…¥ï¼š

arduino
å¤åˆ¶
ç¼–è¾‘
http://<ä½ è¿™å°ç”µè„‘çš„IP>:6104/vnc.html
å³å¯çœ‹åˆ°è¿œç¨‹æ¡Œé¢ç•Œé¢ï¼Œä¸éœ€è¦å®‰è£…ä»»ä½•å®¢æˆ·ç«¯ã€‚

âœ… å¯†ç é»˜è®¤æ˜¯ï¼š
å¤åˆ¶
ç¼–è¾‘
123456
ä½ å¯ä»¥è¿›ç³»ç»Ÿæ‰‹åŠ¨æ”¹å¯†ç ï¼ˆ.vnc\passwdï¼‰ï¼Œæˆ–ç”¨ vncpasswd.exe å·¥å…·ç”Ÿæˆæ–°å¯†ç ã€‚

å¦‚æœä½ éœ€è¦æˆ‘æ‰“ä¸€ä¸ªå®Œæ•´ .zip å®‰è£…åŒ…ï¼ŒæŠŠ noVNCã€NSSMã€Python å®‰è£…å™¨ã€è„šæœ¬éƒ½æ‰“è¿›å»ï¼Œç›´æ¥å‘ç»™ä½ ç”¨â€”â€”ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ï¼

è¦ä¸è¦æˆ‘å¸®ä½ ææˆâ€œæ’ä¸Š U ç›˜å°±èƒ½ä¸€é”®è¿è¡Œâ€çš„ç‰ˆæœ¬ï¼Ÿç»§ç»­æ ä¸‹å»