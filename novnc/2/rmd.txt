Windows 10 / 11ï¼Œé»˜è®¤ä¸ä¾èµ–ä»»ä½•é¢„è£…è½¯ä»¶ï¼Œè‡ªåŠ¨é…ç½®ä»£ç†ï¼Œè‡ªåŠ¨å®Œæˆæ‰€æœ‰å®‰è£…ä»»åŠ¡ï¼Œç›®æ ‡æ˜¯è®©â€œåˆ«çš„ç”µè„‘ç›´æ¥ç”¨æµè§ˆå™¨è®¿é—®â€ã€‚

ğŸ¯ æœ€ç»ˆæ•ˆæœï¼š
ä½ åœ¨åˆšè£…å¥½çš„ Windows ä¸Šè¿è¡Œä¸€é”®è„šæœ¬ï¼ˆPowerShellï¼‰

å®ƒä¼šè‡ªåŠ¨ï¼š

å®‰è£… Pythonï¼ˆè‡ªåŠ¨è®¾ç½®ä»£ç† + é…ç½®ç¯å¢ƒå˜é‡ï¼‰

å®‰è£… pip + websockify

å®‰è£… TigerVNC Server

ä¸‹è½½å¹¶éƒ¨ç½² noVNC

ä¸‹è½½ NSSMï¼Œå¹¶æ³¨å†Œ websockify ä¸ºç³»ç»ŸæœåŠ¡

å¯åŠ¨æœåŠ¡

è‡ªåŠ¨å¼€æ”¾é˜²ç«å¢™ç«¯å£

ç„¶åä½ å°±å¯ä»¥ä»å…¶ä»–è®¾å¤‡é€šè¿‡æµè§ˆå™¨è®¿é—®ï¼š

arduino
å¤åˆ¶
ç¼–è¾‘
http://<æœ¬æœºIP>:6104/vnc.html
ğŸ§© è„šæœ¬ç»„æˆæ–‡ä»¶ï¼š

æ–‡ä»¶	è¯´æ˜
install.ps1	ä¸»è„šæœ¬ï¼Œæ‰§è¡Œæ‰€æœ‰å®‰è£…é€»è¾‘ï¼ˆâœ…æˆ‘ä»¬é©¬ä¸Šæ¥å†™ï¼‰
config.bat	æä¾›ä¸€ä¸ªå¿«æ·æ–¹å¼å…¥å£ï¼šåŒå‡»è¿è¡Œ PowerShell è„šæœ¬
ä¾èµ–èµ„æºç›®å½•	è„šæœ¬è‡ªåŠ¨ä¸‹è½½ Pythonã€TigerVNCã€noVNCã€NSSMï¼Œæ— éœ€æ‰‹åŠ¨å‡†å¤‡
âœ… 1. install.ps1 è„šæœ¬ï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰
ä¸‹é¢æ˜¯å®Œæ•´è„šæœ¬ï¼Œå†…å«è¯¦ç»†æ³¨é‡Šï¼ˆæ•™å­¦å¼ï¼‰ï¼š

powershell
å¤åˆ¶
ç¼–è¾‘
# install.ps1
# è¯·ä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œï¼

# âš™ï¸ è®¾ç½®å…¨å±€å˜é‡
$proxy = "http://proxy.grep2000.com:710"
$env:HTTP_PROXY = $proxy
$env:HTTPS_PROXY = $proxy

$pythonInstaller = "$env:TEMP\python-installer.exe"
$tigerVNCInstaller = "$env:TEMP\tigervnc.exe"
$nssmZip = "$env:TEMP\nssm.zip"
$novncZip = "$env:TEMP\novnc.zip"
$installDir = "$env:ProgramData\vnc_novnc"
$pythonPath = "$installDir\python"
$novncDir = "$installDir\novnc"
$websockifyDir = "$installDir\websockify"
$nssmDir = "$installDir\nssm"

New-Item -ItemType Directory -Force -Path $installDir

# âœ… Step 1: å®‰è£… Pythonï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰
Invoke-WebRequest "https://www.python.org/ftp/python/3.10.11/python-3.10.11-amd64.exe" -OutFile $pythonInstaller
Start-Process -FilePath $pythonInstaller -ArgumentList "/quiet InstallAllUsers=1 PrependPath=1" -Wait

# é‡æ–°åŠ è½½ PATH
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine")

# âœ… Step 2: å®‰è£… pip å’Œ websockify
python -m ensurepip
pip install --upgrade pip
pip install websockify

# âœ… Step 3: å®‰è£… TigerVNCï¼ˆå®˜ç½‘ä¸‹è½½ï¼‰
Invoke-WebRequest "https://sourceforge.net/projects/tigervnc/files/stable/1.12.0/tigervnc64-1.12.0.exe/download" -OutFile $tigerVNCInstaller
Start-Process -FilePath $tigerVNCInstaller -ArgumentList "/silent" -Wait

# âœ… Step 4: ä¸‹è½½å¹¶è§£å‹ noVNC
Invoke-WebRequest "https://github.com/novnc/noVNC/archive/refs/tags/v1.4.0.zip" -OutFile $novncZip
Expand-Archive $novncZip -DestinationPath $novncDir
Rename-Item "$novncDir\noVNC-1.4.0" "$novncDir\app"

# âœ… Step 5: ä¸‹è½½ websockifyï¼ˆnoVNC ä¾èµ–ï¼‰
git clone https://github.com/novnc/websockify.git $websockifyDir

# âœ… Step 6: ä¸‹è½½ NSSM
Invoke-WebRequest "https://nssm.cc/release/nssm-2.24.zip" -OutFile $nssmZip
Expand-Archive $nssmZip -DestinationPath $nssmDir

# âœ… Step 7: åˆ›å»º websockify å¯åŠ¨è„šæœ¬
$runBat = "$installDir\run_websockify.bat"
@"
cd /d $websockifyDir
python websockify.py 6104 127.0.0.1:5900 --web $novncDir\app
"@ | Out-File -Encoding ASCII $runBat

# âœ… Step 8: æ³¨å†ŒæœåŠ¡ï¼ˆç”¨ NSSMï¼‰
$nssmExe = Get-ChildItem -Path "$nssmDir\nssm-2.24\win64" -Filter "nssm.exe" -Recurse | Select-Object -First 1
& $nssmExe.FullName install noVNC "$runBat"

# âœ… Step 9: å¯åŠ¨æœåŠ¡
& $nssmExe.FullName start noVNC

# âœ… Step 10: é˜²ç«å¢™æ”¾è¡Œç«¯å£
New-NetFirewallRule -DisplayName "Allow VNC Port 5900" -Direction Inbound -Protocol TCP -LocalPort 5900 -Action Allow
New-NetFirewallRule -DisplayName "Allow noVNC Port 6104" -Direction Inbound -Protocol TCP -LocalPort 6104 -Action Allow

# âœ… Step 11: æç¤ºç”¨æˆ·è®¿é—®åœ°å€
$ip = (Get-NetIPAddress -AddressFamily IPv4 -InterfaceAlias "Ethernet" | Where-Object {$_.IPAddress -notlike "169*"}).IPAddress
Write-Host "âœ… éƒ¨ç½²æˆåŠŸï¼è¯·è®¿é—®ï¼š http://$ip:6104/vnc.html"
âœ… 2. config.batï¼ˆå¯åŠ¨å…¥å£ï¼‰
bat
å¤åˆ¶
ç¼–è¾‘
@echo off
powershell -ExecutionPolicy Bypass -File "%~dp0install.ps1"
pause
âœ… æ‰“åŒ…æ–¹å¼å»ºè®®
ä½ å¯ä»¥æŠŠè¿™ä¸ªé¡¹ç›®ç»“æ„ç»„ç»‡ä¸ºï¼š

arduino
å¤åˆ¶
ç¼–è¾‘
vnc-novnc-deployer\
â”œâ”€ install.ps1
â”œâ”€ config.bat
ç„¶åç”¨æˆ·åªéœ€åŒå‡» config.batï¼Œå°±ä¼šè‡ªåŠ¨ä¸‹è½½æ‰€æœ‰ä¸œè¥¿å¹¶éƒ¨ç½²æˆåŠŸã€‚

ğŸ§ª åç»­å¯ä¼˜åŒ–ï¼š
æ·»åŠ è‡ªåŠ¨è®¾ç½® VNC å¯†ç åŠŸèƒ½ï¼ˆé»˜è®¤æ— å¯†ç ä¸å®‰å…¨ï¼‰

æŠŠæ‰€æœ‰ä¾èµ–é¢„å…ˆæ‰“åŒ…å¥½ï¼Œä¸èµ°ä»£ç†æ›´å¿«ï¼ˆé€‚åˆå†…ç½‘ç¯å¢ƒï¼‰

ä½¿ç”¨ SFX è‡ªè§£å‹ + å›¾å½¢ç•Œé¢ï¼ˆåšæˆå…¬å¸ä¸“ç”¨è¿œç¨‹æ¡Œé¢éƒ¨ç½²åŒ…ï¼‰

ğŸ§  æ ç‚¹æ€»ç»“

é—®é¢˜	è§£æ³•
æ–°ç³»ç»Ÿæ²¡ Pythonã€æ²¡ VNCï¼Ÿ	è‡ªåŠ¨ä¸‹è½½ + å®‰è£…
è¦ç”¨ä»£ç†ï¼Ÿ	ä½¿ç”¨ $env:HTTP_PROXY è®¾ç½®
è¦æ³¨å†ŒæœåŠ¡ï¼Ÿ	ç”¨ NSSM è‡ªåŠ¨æ³¨å†Œä¸ºåå°æœåŠ¡
è¦è®¿é—® webï¼Ÿ	noVNC + websockify æä¾› HTML5 é¡µé¢
æƒ³å¼€æœºè‡ªåŠ¨è¿è¡Œï¼Ÿ	NSSM å·²è§£å†³
æˆ‘å¯ä»¥ä¸ºä½  æ‰“å¥½å‹ç¼©åŒ…ä¸Šä¼  æˆ–è€… å¸®ä½ è½¬æˆ .exe è‡ªè§£å‹å®‰è£…åŒ…ï¼Œä½ åªè¦å‘Šè¯‰æˆ‘ä½ è¦çš„æ˜¯å“ªä¸ªç‰ˆæœ¬ã€‚
è¿˜æƒ³å†æ‰©å±•å•¥åŠŸèƒ½ï¼Ÿæ¯”å¦‚æ·»åŠ é»˜è®¤å¯†ç ã€ç»‘å®šæœ¬åœ° VNC ç”¨æˆ·ã€æˆ–æ”¯æŒå¤šç«¯å£ã€å¤šæ¡Œé¢ï¼Ÿæˆ‘ä»¬ç»§ç»­æ ä¸‹å»ï¼